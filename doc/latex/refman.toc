\contentsline {chapter}{\numberline {1}Phone Firewall Data Structure Index}{1}{chapter.1}
\contentsline {section}{\numberline {1.1}Phone Firewall Data Structures}{1}{section.1.1}
\contentsline {chapter}{\numberline {2}Phone Firewall File Index}{3}{chapter.2}
\contentsline {section}{\numberline {2.1}Phone Firewall File List}{3}{section.2.1}
\contentsline {chapter}{\numberline {3}Phone Firewall Data Structure Documentation}{5}{chapter.3}
\contentsline {section}{\numberline {3.1}Entry Struct Reference}{5}{section.3.1}
\contentsline {subsection}{\numberline {3.1.1}Detailed Description}{5}{subsection.3.1.1}
\contentsline {subsection}{\numberline {3.1.2}Field Documentation}{5}{subsection.3.1.2}
\contentsline {subsubsection}{\numberline {3.1.2.1}\setlength {\rightskip }{0pt plus 5cm}int {\bf Entry::country\_\discretionary {-}{}{}code}}{5}{subsubsection.3.1.2.1}
\contentsline {subsubsection}{\numberline {3.1.2.2}\setlength {\rightskip }{0pt plus 5cm}int {\bf Entry::area\_\discretionary {-}{}{}code}}{6}{subsubsection.3.1.2.2}
\contentsline {subsubsection}{\numberline {3.1.2.3}\setlength {\rightskip }{0pt plus 5cm}unsigned long long {\bf Entry::number}}{6}{subsubsection.3.1.2.3}
\contentsline {subsubsection}{\numberline {3.1.2.4}\setlength {\rightskip }{0pt plus 5cm}char$\ast $ {\bf Entry::name}}{6}{subsubsection.3.1.2.4}
\contentsline {subsubsection}{\numberline {3.1.2.5}\setlength {\rightskip }{0pt plus 5cm}char$\ast $ {\bf Entry::reason}}{6}{subsubsection.3.1.2.5}
\contentsline {subsubsection}{\numberline {3.1.2.6}\setlength {\rightskip }{0pt plus 5cm}int {\bf Entry::priority}}{6}{subsubsection.3.1.2.6}
\contentsline {subsubsection}{\numberline {3.1.2.7}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ {\bf Entry::next}\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{6}{subsubsection.3.1.2.7}
\contentsline {section}{\numberline {3.2}entry Struct Reference}{7}{section.3.2}
\contentsline {subsection}{\numberline {3.2.1}Detailed Description}{7}{subsection.3.2.1}
\contentsline {chapter}{\numberline {4}Phone Firewall File Documentation}{9}{chapter.4}
\contentsline {section}{\numberline {4.1}libphonefirewall.h File Reference}{9}{section.4.1}
\contentsline {subsection}{\numberline {4.1.1}Detailed Description}{10}{subsection.4.1.1}
\contentsline {subsection}{\numberline {4.1.2}Define Documentation}{10}{subsection.4.1.2}
\contentsline {subsubsection}{\numberline {4.1.2.1}\setlength {\rightskip }{0pt plus 5cm}\#define BLACKLIST\_\discretionary {-}{}{}FLAG\nobreakspace {}0x01}{10}{subsubsection.4.1.2.1}
\contentsline {subsubsection}{\numberline {4.1.2.2}\setlength {\rightskip }{0pt plus 5cm}\#define COMPONENT\_\discretionary {-}{}{}NAME\nobreakspace {}\char `\"{}phone firewall\char `\"{}}{10}{subsubsection.4.1.2.2}
\contentsline {subsubsection}{\numberline {4.1.2.3}\setlength {\rightskip }{0pt plus 5cm}\#define DB\_\discretionary {-}{}{}FILE\nobreakspace {}\char `\"{}db/phone-firewall.db\char `\"{}}{10}{subsubsection.4.1.2.3}
\contentsline {subsubsection}{\numberline {4.1.2.4}\setlength {\rightskip }{0pt plus 5cm}\#define MAX\_\discretionary {-}{}{}LINE\_\discretionary {-}{}{}LENGTH\nobreakspace {}512}{10}{subsubsection.4.1.2.4}
\contentsline {subsubsection}{\numberline {4.1.2.5}\setlength {\rightskip }{0pt plus 5cm}\#define PRIO\_\discretionary {-}{}{}ALL\nobreakspace {}-999}{11}{subsubsection.4.1.2.5}
\contentsline {subsubsection}{\numberline {4.1.2.6}\setlength {\rightskip }{0pt plus 5cm}\#define STMT\_\discretionary {-}{}{}SIZE\nobreakspace {}1024}{11}{subsubsection.4.1.2.6}
\contentsline {subsubsection}{\numberline {4.1.2.7}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}AREACODE\nobreakspace {}\char `\"{}areacode\char `\"{}}{11}{subsubsection.4.1.2.7}
\contentsline {subsubsection}{\numberline {4.1.2.8}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}COUNTRYCODE\nobreakspace {}\char `\"{}countrycode\char `\"{}}{11}{subsubsection.4.1.2.8}
\contentsline {subsubsection}{\numberline {4.1.2.9}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}NAME\nobreakspace {}\char `\"{}name\char `\"{}}{11}{subsubsection.4.1.2.9}
\contentsline {subsubsection}{\numberline {4.1.2.10}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}NUMBER\nobreakspace {}\char `\"{}number\char `\"{}}{11}{subsubsection.4.1.2.10}
\contentsline {subsubsection}{\numberline {4.1.2.11}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}PRIORITY\nobreakspace {}\char `\"{}priority\char `\"{}}{11}{subsubsection.4.1.2.11}
\contentsline {subsubsection}{\numberline {4.1.2.12}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}REASON\nobreakspace {}\char `\"{}reason\char `\"{}}{12}{subsubsection.4.1.2.12}
\contentsline {subsubsection}{\numberline {4.1.2.13}\setlength {\rightskip }{0pt plus 5cm}\#define WHITELIST\_\discretionary {-}{}{}FLAG\nobreakspace {}0x02}{12}{subsubsection.4.1.2.13}
\contentsline {section}{\numberline {4.2}logfile.c File Reference}{13}{section.4.2}
\contentsline {subsection}{\numberline {4.2.1}Function Documentation}{13}{subsection.4.2.1}
\contentsline {subsubsection}{\numberline {4.2.1.1}\setlength {\rightskip }{0pt plus 5cm}char$\ast $ asctime (const struct tm $\ast $ {\em timeptr})}{13}{subsubsection.4.2.1.1}
\contentsline {subsubsection}{\numberline {4.2.1.2}\setlength {\rightskip }{0pt plus 5cm}int write\_\discretionary {-}{}{}logentry (char $\ast $ {\em msg}, char $\ast $ {\em component}, int {\em flag})}{13}{subsubsection.4.2.1.2}
\contentsline {section}{\numberline {4.3}logfile.h File Reference}{15}{section.4.3}
\contentsline {subsection}{\numberline {4.3.1}Define Documentation}{15}{subsection.4.3.1}
\contentsline {subsubsection}{\numberline {4.3.1.1}\setlength {\rightskip }{0pt plus 5cm}\#define ERR\_\discretionary {-}{}{}FLAG\nobreakspace {}1}{15}{subsubsection.4.3.1.1}
\contentsline {subsubsection}{\numberline {4.3.1.2}\setlength {\rightskip }{0pt plus 5cm}\#define ERR\_\discretionary {-}{}{}LOG(m)\nobreakspace {}write\_\discretionary {-}{}{}logentry(m, COMPONENT\_\discretionary {-}{}{}NAME, ERR\_\discretionary {-}{}{}FLAG)}{15}{subsubsection.4.3.1.2}
\contentsline {subsubsection}{\numberline {4.3.1.3}\setlength {\rightskip }{0pt plus 5cm}\#define INFO\_\discretionary {-}{}{}FLAG\nobreakspace {}3}{15}{subsubsection.4.3.1.3}
\contentsline {subsubsection}{\numberline {4.3.1.4}\setlength {\rightskip }{0pt plus 5cm}\#define INFO\_\discretionary {-}{}{}LOG(m)\nobreakspace {}write\_\discretionary {-}{}{}logentry(m, COMPONENT\_\discretionary {-}{}{}NAME, INFO\_\discretionary {-}{}{}FLAG)}{16}{subsubsection.4.3.1.4}
\contentsline {subsubsection}{\numberline {4.3.1.5}\setlength {\rightskip }{0pt plus 5cm}\#define LOGFILE\nobreakspace {}\char `\"{}/tmp/phonefirewall.log\char `\"{}}{16}{subsubsection.4.3.1.5}
\contentsline {subsubsection}{\numberline {4.3.1.6}\setlength {\rightskip }{0pt plus 5cm}\#define MAX\_\discretionary {-}{}{}ENTRY\_\discretionary {-}{}{}LENGTH\nobreakspace {}128}{16}{subsubsection.4.3.1.6}
\contentsline {subsubsection}{\numberline {4.3.1.7}\setlength {\rightskip }{0pt plus 5cm}\#define UNKNOWN\nobreakspace {}0}{16}{subsubsection.4.3.1.7}
\contentsline {subsubsection}{\numberline {4.3.1.8}\setlength {\rightskip }{0pt plus 5cm}\#define UNKNOWN\_\discretionary {-}{}{}LOG(m)\nobreakspace {}write\_\discretionary {-}{}{}logentry(m, COMPONENT\_\discretionary {-}{}{}NAME, UNKNOWN\_\discretionary {-}{}{}FLAG)}{16}{subsubsection.4.3.1.8}
\contentsline {subsubsection}{\numberline {4.3.1.9}\setlength {\rightskip }{0pt plus 5cm}\#define WARN\_\discretionary {-}{}{}FLAG\nobreakspace {}2}{16}{subsubsection.4.3.1.9}
\contentsline {subsubsection}{\numberline {4.3.1.10}\setlength {\rightskip }{0pt plus 5cm}\#define WARN\_\discretionary {-}{}{}LOG(m)\nobreakspace {}write\_\discretionary {-}{}{}logentry(m, COMPONENT\_\discretionary {-}{}{}NAME, WARN\_\discretionary {-}{}{}FLAG)}{16}{subsubsection.4.3.1.10}
\contentsline {subsection}{\numberline {4.3.2}Function Documentation}{16}{subsection.4.3.2}
\contentsline {subsubsection}{\numberline {4.3.2.1}\setlength {\rightskip }{0pt plus 5cm}int write\_\discretionary {-}{}{}logentry (char $\ast $ {\em msg}, char $\ast $ {\em component}, int {\em flag})}{16}{subsubsection.4.3.2.1}
\contentsline {section}{\numberline {4.4}pf\_\discretionary {-}{}{}administration.c File Reference}{18}{section.4.4}
\contentsline {subsection}{\numberline {4.4.1}Function Documentation}{18}{subsection.4.4.1}
\contentsline {subsubsection}{\numberline {4.4.1.1}\setlength {\rightskip }{0pt plus 5cm}int add\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em name}, char $\ast $ {\em reason}, int {\em priority}, int {\em listflag})}{18}{subsubsection.4.4.1.1}
\contentsline {subsubsection}{\numberline {4.4.1.2}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}name (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em new\_\discretionary {-}{}{}name}, int {\em listflag})}{19}{subsubsection.4.4.1.2}
\contentsline {subsubsection}{\numberline {4.4.1.3}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em new\_\discretionary {-}{}{}country\_\discretionary {-}{}{}code}, int {\em new\_\discretionary {-}{}{}area\_\discretionary {-}{}{}code}, unsigned long long {\em new\_\discretionary {-}{}{}number}, int {\em listflag})}{19}{subsubsection.4.4.1.3}
\contentsline {subsubsection}{\numberline {4.4.1.4}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}priority (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em new\_\discretionary {-}{}{}priority}, int {\em listflag})}{20}{subsubsection.4.4.1.4}
\contentsline {subsubsection}{\numberline {4.4.1.5}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}reason (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em new\_\discretionary {-}{}{}reason}, int {\em listflag})}{20}{subsubsection.4.4.1.5}
\contentsline {subsubsection}{\numberline {4.4.1.6}\setlength {\rightskip }{0pt plus 5cm}int check\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em priority}, int {\em listflag})}{21}{subsubsection.4.4.1.6}
\contentsline {subsubsection}{\numberline {4.4.1.7}\setlength {\rightskip }{0pt plus 5cm}int evaluate\_\discretionary {-}{}{}stmt (sqlite3\_\discretionary {-}{}{}stmt $\ast $ {\em pp\_\discretionary {-}{}{}stmt}, struct {\bf Entry} $\ast $ {\em p\_\discretionary {-}{}{}entry})}{21}{subsubsection.4.4.1.7}
\contentsline {subsubsection}{\numberline {4.4.1.8}\setlength {\rightskip }{0pt plus 5cm}int rm\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em listlfag})}{22}{subsubsection.4.4.1.8}
\contentsline {section}{\numberline {4.5}pf\_\discretionary {-}{}{}administration.h File Reference}{23}{section.4.5}
\contentsline {subsection}{\numberline {4.5.1}Function Documentation}{23}{subsection.4.5.1}
\contentsline {subsubsection}{\numberline {4.5.1.1}\setlength {\rightskip }{0pt plus 5cm}int add\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em name}, char $\ast $ {\em reason}, int {\em priority}, int {\em listflag})}{23}{subsubsection.4.5.1.1}
\contentsline {subsubsection}{\numberline {4.5.1.2}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}name (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em new\_\discretionary {-}{}{}name}, int {\em listflag})}{24}{subsubsection.4.5.1.2}
\contentsline {subsubsection}{\numberline {4.5.1.3}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em new\_\discretionary {-}{}{}country\_\discretionary {-}{}{}code}, int {\em new\_\discretionary {-}{}{}area\_\discretionary {-}{}{}code}, unsigned long long {\em new\_\discretionary {-}{}{}number}, int {\em listflag})}{24}{subsubsection.4.5.1.3}
\contentsline {subsubsection}{\numberline {4.5.1.4}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}priority (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em new\_\discretionary {-}{}{}priority}, int {\em listflag})}{25}{subsubsection.4.5.1.4}
\contentsline {subsubsection}{\numberline {4.5.1.5}\setlength {\rightskip }{0pt plus 5cm}int change\_\discretionary {-}{}{}reason (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em new\_\discretionary {-}{}{}reason}, int {\em listflag})}{25}{subsubsection.4.5.1.5}
\contentsline {subsubsection}{\numberline {4.5.1.6}\setlength {\rightskip }{0pt plus 5cm}int check\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em priority}, int {\em listflag})}{26}{subsubsection.4.5.1.6}
\contentsline {subsubsection}{\numberline {4.5.1.7}\setlength {\rightskip }{0pt plus 5cm}int rm\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em listlfag})}{26}{subsubsection.4.5.1.7}
\contentsline {section}{\numberline {4.6}pf\_\discretionary {-}{}{}search.c File Reference}{27}{section.4.6}
\contentsline {subsection}{\numberline {4.6.1}Define Documentation}{27}{subsection.4.6.1}
\contentsline {subsubsection}{\numberline {4.6.1.1}\setlength {\rightskip }{0pt plus 5cm}\#define ASCII\_\discretionary {-}{}{}PERCENT\_\discretionary {-}{}{}CHAR\nobreakspace {}37}{27}{subsubsection.4.6.1.1}
\contentsline {subsection}{\numberline {4.6.2}Function Documentation}{27}{subsection.4.6.2}
\contentsline {subsubsection}{\numberline {4.6.2.1}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ find\_\discretionary {-}{}{}entry (sqlite3\_\discretionary {-}{}{}stmt $\ast $ {\em pp\_\discretionary {-}{}{}stmt})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{27}{subsubsection.4.6.2.1}
\contentsline {subsubsection}{\numberline {4.6.2.2}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (char $\ast $ {\em name}, int {\em listflag})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{28}{subsubsection.4.6.2.2}
\contentsline {subsubsection}{\numberline {4.6.2.3}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em listflag})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{28}{subsubsection.4.6.2.3}
\contentsline {subsubsection}{\numberline {4.6.2.4}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}reason (char $\ast $ {\em reason}, int {\em listflag})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{29}{subsubsection.4.6.2.4}
\contentsline {subsubsection}{\numberline {4.6.2.5}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ insert\_\discretionary {-}{}{}into\_\discretionary {-}{}{}list (struct {\bf Entry} $\ast $ {\em p\_\discretionary {-}{}{}root}, struct {\bf Entry} $\ast $ {\em p\_\discretionary {-}{}{}entry})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{29}{subsubsection.4.6.2.5}
\contentsline {section}{\numberline {4.7}pf\_\discretionary {-}{}{}search.h File Reference}{31}{section.4.7}
\contentsline {subsection}{\numberline {4.7.1}Function Documentation}{31}{subsection.4.7.1}
\contentsline {subsubsection}{\numberline {4.7.1.1}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (char $\ast $ {\em name}, int {\em listflag})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{31}{subsubsection.4.7.1.1}
\contentsline {subsubsection}{\numberline {4.7.1.2}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em listflag})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{32}{subsubsection.4.7.1.2}
\contentsline {subsubsection}{\numberline {4.7.1.3}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}reason (char $\ast $ {\em reason}, int {\em listflag})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{32}{subsubsection.4.7.1.3}
