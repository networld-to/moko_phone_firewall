\contentsline {chapter}{\numberline {1}Phone Firewall Data Structure Index}{1}{chapter.1}
\contentsline {section}{\numberline {1.1}Phone Firewall Data Structures}{1}{section.1.1}
\contentsline {chapter}{\numberline {2}Phone Firewall File Index}{3}{chapter.2}
\contentsline {section}{\numberline {2.1}Phone Firewall File List}{3}{section.2.1}
\contentsline {chapter}{\numberline {3}Phone Firewall Data Structure Documentation}{5}{chapter.3}
\contentsline {section}{\numberline {3.1}Entry Struct Reference}{5}{section.3.1}
\contentsline {subsection}{\numberline {3.1.1}Detailed Description}{5}{subsection.3.1.1}
\contentsline {subsection}{\numberline {3.1.2}Field Documentation}{5}{subsection.3.1.2}
\contentsline {subsubsection}{\numberline {3.1.2.1}\setlength {\rightskip }{0pt plus 5cm}int {\bf Entry::country\_\discretionary {-}{}{}code}}{5}{subsubsection.3.1.2.1}
\contentsline {subsubsection}{\numberline {3.1.2.2}\setlength {\rightskip }{0pt plus 5cm}int {\bf Entry::area\_\discretionary {-}{}{}code}}{5}{subsubsection.3.1.2.2}
\contentsline {subsubsection}{\numberline {3.1.2.3}\setlength {\rightskip }{0pt plus 5cm}unsigned long long {\bf Entry::number}}{6}{subsubsection.3.1.2.3}
\contentsline {subsubsection}{\numberline {3.1.2.4}\setlength {\rightskip }{0pt plus 5cm}char$\ast $ {\bf Entry::name}}{6}{subsubsection.3.1.2.4}
\contentsline {subsubsection}{\numberline {3.1.2.5}\setlength {\rightskip }{0pt plus 5cm}char$\ast $ {\bf Entry::reason}}{6}{subsubsection.3.1.2.5}
\contentsline {subsubsection}{\numberline {3.1.2.6}\setlength {\rightskip }{0pt plus 5cm}int {\bf Entry::priority}}{6}{subsubsection.3.1.2.6}
\contentsline {section}{\numberline {3.2}entry Struct Reference}{7}{section.3.2}
\contentsline {subsection}{\numberline {3.2.1}Detailed Description}{7}{subsection.3.2.1}
\contentsline {chapter}{\numberline {4}Phone Firewall File Documentation}{9}{chapter.4}
\contentsline {section}{\numberline {4.1}libphonefirewall.h File Reference}{9}{section.4.1}
\contentsline {subsection}{\numberline {4.1.1}Detailed Description}{10}{subsection.4.1.1}
\contentsline {subsection}{\numberline {4.1.2}Define Documentation}{10}{subsection.4.1.2}
\contentsline {subsubsection}{\numberline {4.1.2.1}\setlength {\rightskip }{0pt plus 5cm}\#define DB\_\discretionary {-}{}{}FILE\nobreakspace {}\char `\"{}db/phone-firewall.db\char `\"{}}{10}{subsubsection.4.1.2.1}
\contentsline {subsubsection}{\numberline {4.1.2.2}\setlength {\rightskip }{0pt plus 5cm}\#define MAX\_\discretionary {-}{}{}LINE\_\discretionary {-}{}{}LENGTH\nobreakspace {}512}{10}{subsubsection.4.1.2.2}
\contentsline {subsubsection}{\numberline {4.1.2.3}\setlength {\rightskip }{0pt plus 5cm}\#define PRIO\_\discretionary {-}{}{}ALL\nobreakspace {}-999}{10}{subsubsection.4.1.2.3}
\contentsline {subsubsection}{\numberline {4.1.2.4}\setlength {\rightskip }{0pt plus 5cm}\#define STMT\_\discretionary {-}{}{}SIZE\nobreakspace {}1024}{11}{subsubsection.4.1.2.4}
\contentsline {subsubsection}{\numberline {4.1.2.5}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}AREACODE\nobreakspace {}\char `\"{}areacode\char `\"{}}{11}{subsubsection.4.1.2.5}
\contentsline {subsubsection}{\numberline {4.1.2.6}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}COUNTRYCODE\nobreakspace {}\char `\"{}countrycode\char `\"{}}{11}{subsubsection.4.1.2.6}
\contentsline {subsubsection}{\numberline {4.1.2.7}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}NAME\nobreakspace {}\char `\"{}name\char `\"{}}{11}{subsubsection.4.1.2.7}
\contentsline {subsubsection}{\numberline {4.1.2.8}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}NUMBER\nobreakspace {}\char `\"{}number\char `\"{}}{11}{subsubsection.4.1.2.8}
\contentsline {subsubsection}{\numberline {4.1.2.9}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}PRIORITY\nobreakspace {}\char `\"{}priority\char `\"{}}{11}{subsubsection.4.1.2.9}
\contentsline {subsubsection}{\numberline {4.1.2.10}\setlength {\rightskip }{0pt plus 5cm}\#define TB\_\discretionary {-}{}{}REASON\nobreakspace {}\char `\"{}reason\char `\"{}}{11}{subsubsection.4.1.2.10}
\contentsline {subsection}{\numberline {4.1.3}Function Documentation}{12}{subsection.4.1.3}
\contentsline {subsubsection}{\numberline {4.1.3.1}\setlength {\rightskip }{0pt plus 5cm}int add\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em name}, char $\ast $ {\em reason}, int {\em priority})}{12}{subsubsection.4.1.3.1}
\contentsline {subsubsection}{\numberline {4.1.3.2}\setlength {\rightskip }{0pt plus 5cm}int add\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em name}, char $\ast $ {\em reason}, int {\em priority})}{12}{subsubsection.4.1.3.2}
\contentsline {subsubsection}{\numberline {4.1.3.3}\setlength {\rightskip }{0pt plus 5cm}int check\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em priority})}{13}{subsubsection.4.1.3.3}
\contentsline {subsubsection}{\numberline {4.1.3.4}\setlength {\rightskip }{0pt plus 5cm}int check\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em priority})}{13}{subsubsection.4.1.3.4}
\contentsline {subsubsection}{\numberline {4.1.3.5}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (char $\ast $ {\em name})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{14}{subsubsection.4.1.3.5}
\contentsline {subsubsection}{\numberline {4.1.3.6}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{14}{subsubsection.4.1.3.6}
\contentsline {subsubsection}{\numberline {4.1.3.7}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (char $\ast $ {\em name})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{15}{subsubsection.4.1.3.7}
\contentsline {subsubsection}{\numberline {4.1.3.8}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{15}{subsubsection.4.1.3.8}
\contentsline {subsubsection}{\numberline {4.1.3.9}\setlength {\rightskip }{0pt plus 5cm}int rm\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})}{15}{subsubsection.4.1.3.9}
\contentsline {subsubsection}{\numberline {4.1.3.10}\setlength {\rightskip }{0pt plus 5cm}int rm\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})}{16}{subsubsection.4.1.3.10}
\contentsline {subsection}{\numberline {4.1.4}Variable Documentation}{16}{subsection.4.1.4}
\contentsline {subsubsection}{\numberline {4.1.4.1}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry} {\bf entry}}{16}{subsubsection.4.1.4.1}
\contentsline {section}{\numberline {4.2}logfile.c File Reference}{17}{section.4.2}
\contentsline {subsection}{\numberline {4.2.1}Function Documentation}{17}{subsection.4.2.1}
\contentsline {subsubsection}{\numberline {4.2.1.1}\setlength {\rightskip }{0pt plus 5cm}char$\ast $ asctime (const struct tm $\ast $ {\em timeptr})}{17}{subsubsection.4.2.1.1}
\contentsline {subsubsection}{\numberline {4.2.1.2}\setlength {\rightskip }{0pt plus 5cm}int write\_\discretionary {-}{}{}logentry (char $\ast $ {\em msg}, char $\ast $ {\em component}, int {\em flag})}{18}{subsubsection.4.2.1.2}
\contentsline {section}{\numberline {4.3}logfile.h File Reference}{20}{section.4.3}
\contentsline {subsection}{\numberline {4.3.1}Define Documentation}{20}{subsection.4.3.1}
\contentsline {subsubsection}{\numberline {4.3.1.1}\setlength {\rightskip }{0pt plus 5cm}\#define ERR\_\discretionary {-}{}{}FLAG\nobreakspace {}1}{20}{subsubsection.4.3.1.1}
\contentsline {subsubsection}{\numberline {4.3.1.2}\setlength {\rightskip }{0pt plus 5cm}\#define INFO\_\discretionary {-}{}{}FLAG\nobreakspace {}3}{20}{subsubsection.4.3.1.2}
\contentsline {subsubsection}{\numberline {4.3.1.3}\setlength {\rightskip }{0pt plus 5cm}\#define LOGFILE\nobreakspace {}\char `\"{}log/moksec.log\char `\"{}}{20}{subsubsection.4.3.1.3}
\contentsline {subsubsection}{\numberline {4.3.1.4}\setlength {\rightskip }{0pt plus 5cm}\#define MAX\_\discretionary {-}{}{}ENTRY\_\discretionary {-}{}{}LENGTH\nobreakspace {}128}{20}{subsubsection.4.3.1.4}
\contentsline {subsubsection}{\numberline {4.3.1.5}\setlength {\rightskip }{0pt plus 5cm}\#define UNKNOWN\nobreakspace {}0}{21}{subsubsection.4.3.1.5}
\contentsline {subsubsection}{\numberline {4.3.1.6}\setlength {\rightskip }{0pt plus 5cm}\#define WARN\_\discretionary {-}{}{}FLAG\nobreakspace {}2}{21}{subsubsection.4.3.1.6}
\contentsline {subsection}{\numberline {4.3.2}Function Documentation}{21}{subsection.4.3.2}
\contentsline {subsubsection}{\numberline {4.3.2.1}\setlength {\rightskip }{0pt plus 5cm}int write\_\discretionary {-}{}{}logentry (char $\ast $ {\em msg}, char $\ast $ {\em component}, int {\em flag})}{21}{subsubsection.4.3.2.1}
\contentsline {section}{\numberline {4.4}pf\_\discretionary {-}{}{}daemon.c File Reference}{23}{section.4.4}
\contentsline {subsection}{\numberline {4.4.1}Function Documentation}{23}{subsection.4.4.1}
\contentsline {subsubsection}{\numberline {4.4.1.1}\setlength {\rightskip }{0pt plus 5cm}void dbus\_\discretionary {-}{}{}listen ()}{23}{subsubsection.4.4.1.1}
\contentsline {subsubsection}{\numberline {4.4.1.2}\setlength {\rightskip }{0pt plus 5cm}void install\_\discretionary {-}{}{}sigaction ()}{24}{subsubsection.4.4.1.2}
\contentsline {subsubsection}{\numberline {4.4.1.3}\setlength {\rightskip }{0pt plus 5cm}int main (int {\em argc}, char $\ast $$\ast $ {\em argv})}{24}{subsubsection.4.4.1.3}
\contentsline {subsubsection}{\numberline {4.4.1.4}\setlength {\rightskip }{0pt plus 5cm}void react\_\discretionary {-}{}{}to\_\discretionary {-}{}{}signal (int {\em sig})}{24}{subsubsection.4.4.1.4}
\contentsline {subsubsection}{\numberline {4.4.1.5}\setlength {\rightskip }{0pt plus 5cm}void start\_\discretionary {-}{}{}daemon ()}{25}{subsubsection.4.4.1.5}
\contentsline {subsubsection}{\numberline {4.4.1.6}\setlength {\rightskip }{0pt plus 5cm}void stop\_\discretionary {-}{}{}daemon ()}{25}{subsubsection.4.4.1.6}
\contentsline {section}{\numberline {4.5}pf\_\discretionary {-}{}{}daemon.h File Reference}{26}{section.4.5}
\contentsline {subsection}{\numberline {4.5.1}Define Documentation}{26}{subsection.4.5.1}
\contentsline {subsubsection}{\numberline {4.5.1.1}\setlength {\rightskip }{0pt plus 5cm}\#define LOCKFILE\nobreakspace {}\char `\"{}.lock\char `\"{}}{26}{subsubsection.4.5.1.1}
\contentsline {subsection}{\numberline {4.5.2}Function Documentation}{26}{subsection.4.5.2}
\contentsline {subsubsection}{\numberline {4.5.2.1}\setlength {\rightskip }{0pt plus 5cm}void dbus\_\discretionary {-}{}{}listen ()}{26}{subsubsection.4.5.2.1}
\contentsline {subsubsection}{\numberline {4.5.2.2}\setlength {\rightskip }{0pt plus 5cm}void start\_\discretionary {-}{}{}daemon ()}{26}{subsubsection.4.5.2.2}
\contentsline {subsubsection}{\numberline {4.5.2.3}\setlength {\rightskip }{0pt plus 5cm}void stop\_\discretionary {-}{}{}daemon ()}{26}{subsubsection.4.5.2.3}
\contentsline {section}{\numberline {4.6}phonefirewall\_\discretionary {-}{}{}administration.c File Reference}{27}{section.4.6}
\contentsline {subsection}{\numberline {4.6.1}Function Documentation}{27}{subsection.4.6.1}
\contentsline {subsubsection}{\numberline {4.6.1.1}\setlength {\rightskip }{0pt plus 5cm}int add\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em name}, char $\ast $ {\em reason}, int {\em priority})}{27}{subsubsection.4.6.1.1}
\contentsline {subsubsection}{\numberline {4.6.1.2}\setlength {\rightskip }{0pt plus 5cm}int add\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, char $\ast $ {\em name}, char $\ast $ {\em reason}, int {\em priority})}{28}{subsubsection.4.6.1.2}
\contentsline {subsubsection}{\numberline {4.6.1.3}\setlength {\rightskip }{0pt plus 5cm}int check\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em priority})}{28}{subsubsection.4.6.1.3}
\contentsline {subsubsection}{\numberline {4.6.1.4}\setlength {\rightskip }{0pt plus 5cm}int check\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number}, int {\em priority})}{29}{subsubsection.4.6.1.4}
\contentsline {subsubsection}{\numberline {4.6.1.5}\setlength {\rightskip }{0pt plus 5cm}int evaluate\_\discretionary {-}{}{}stmt (sqlite3\_\discretionary {-}{}{}stmt $\ast $ {\em pp\_\discretionary {-}{}{}stmt}, struct {\bf Entry} $\ast $ {\em p\_\discretionary {-}{}{}entry})}{30}{subsubsection.4.6.1.5}
\contentsline {subsubsection}{\numberline {4.6.1.6}\setlength {\rightskip }{0pt plus 5cm}int rm\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})}{30}{subsubsection.4.6.1.6}
\contentsline {subsubsection}{\numberline {4.6.1.7}\setlength {\rightskip }{0pt plus 5cm}int rm\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})}{30}{subsubsection.4.6.1.7}
\contentsline {section}{\numberline {4.7}phonefirewall\_\discretionary {-}{}{}search.c File Reference}{32}{section.4.7}
\contentsline {subsection}{\numberline {4.7.1}Define Documentation}{32}{subsection.4.7.1}
\contentsline {subsubsection}{\numberline {4.7.1.1}\setlength {\rightskip }{0pt plus 5cm}\#define ASCII\_\discretionary {-}{}{}PERCENT\_\discretionary {-}{}{}CHAR\nobreakspace {}37}{32}{subsubsection.4.7.1.1}
\contentsline {subsubsection}{\numberline {4.7.1.2}\setlength {\rightskip }{0pt plus 5cm}\#define MAX\_\discretionary {-}{}{}ENTRY\_\discretionary {-}{}{}ARRAY\nobreakspace {}1024}{33}{subsubsection.4.7.1.2}
\contentsline {subsection}{\numberline {4.7.2}Function Documentation}{33}{subsection.4.7.2}
\contentsline {subsubsection}{\numberline {4.7.2.1}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ find\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (sqlite3\_\discretionary {-}{}{}stmt $\ast $ {\em pp\_\discretionary {-}{}{}stmt}, char $\ast $ {\em name})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{33}{subsubsection.4.7.2.1}
\contentsline {subsubsection}{\numberline {4.7.2.2}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (char $\ast $ {\em name})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{33}{subsubsection.4.7.2.2}
\contentsline {subsubsection}{\numberline {4.7.2.3}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}blacklist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{33}{subsubsection.4.7.2.3}
\contentsline {subsubsection}{\numberline {4.7.2.4}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}name (char $\ast $ {\em name})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{34}{subsubsection.4.7.2.4}
\contentsline {subsubsection}{\numberline {4.7.2.5}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ get\_\discretionary {-}{}{}whitelist\_\discretionary {-}{}{}entry\_\discretionary {-}{}{}by\_\discretionary {-}{}{}number (int {\em country\_\discretionary {-}{}{}code}, int {\em area\_\discretionary {-}{}{}code}, unsigned long long {\em number})\hspace {0.3cm}{\tt \unhbox \voidb@x \hbox {[}read\unhbox \voidb@x \hbox {]}}}{34}{subsubsection.4.7.2.5}
\contentsline {subsection}{\numberline {4.7.3}Variable Documentation}{34}{subsection.4.7.3}
\contentsline {subsubsection}{\numberline {4.7.3.1}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry} {\bf entry\_\discretionary {-}{}{}array}\unhbox \voidb@x \hbox {[}MAX\_\discretionary {-}{}{}ENTRY\_\discretionary {-}{}{}ARRAY\unhbox \voidb@x \hbox {]}}{34}{subsubsection.4.7.3.1}
\contentsline {subsubsection}{\numberline {4.7.3.2}\setlength {\rightskip }{0pt plus 5cm}struct {\bf Entry}$\ast $ {\bf p\_\discretionary {-}{}{}entry} = \&{\bf entry}}{34}{subsubsection.4.7.3.2}
